Tor Browser Bundle test suite
=============================

Installation
------------

To run the test suite, you need perl and the following perl modules:

  Cwd
  Data::Dump
  Digest::SHA
  File::Copy
  File::Path
  File::Slurp
  File::Spec
  File::Temp
  FindBin
  Getopt::Long
  IO::CaptureOutput
  IO::Socket::INET
  Image::Magick
  JSON
  LWP::UserAgent
  Template
  YAML

If you are using Fedora or other yum based distribution, you can install
each module with 'yum install perl(ModuleName)'.

The test suite also requires mozmill and python selenium, which we install
using a virtualenv. You can use the 'setup' script to install them into
a virtualenv:

  $ ./setup

If you want to reinstall the virtualenv used, remove the 'virtualenv'
directory and run 'setup' again.


Usage
-----

 $ ./tbb-testsuite [options] <tbb-file>...

The <tbb-file> can be:

- the path to a tbb tarball file.

- the path to a sha256sum file. In which case all tarballs listed in the
  sha256sum and compatible with the current platform will be tested.

- the URL of a tbb tarball, which will be downloaded before being tested.

- the URL of a sha256sum file, which will be downloaded. The gpg signature
  from file sha256sum.asc will also be downloaded and checked with the
  keyring selected with the --keyring option, unless the --no-gpgcheck
  option is used. All the tarballs listed in the sha256sum and compatible
  with the current platform will be downloaded, have their checksum
  checked and will be tested.


Available options
-----------------

--no-gpgcheck
        Disable gpg check when downloading a sha256sum.txt file.

--keyring
        Name of the keyring used to check the gpg signature of a
        downloaded sha256sum.txt file.

--no-mozmill
        Don't run mozmill tests.

--no-selenium
        Don't run the Selenium tests.

--no-start-tor
        Don't start a tor daemon. If you use this option, you should
        already have a tor daemon running.

--tor-control-port=<port>
        Select the tor control port number. Default is 9551.

--tor-socks-port=<port>
        Select the tor socks port. Default is 9550.

--reports-dir=<directory>
        Directory where the tests reports are saved.

--virtualenv=<directory>
        Path to the virtualenv where selenium and mozmill are installed.
        The default is the 'virtualenv' directory created by the 'setup'
        script.

