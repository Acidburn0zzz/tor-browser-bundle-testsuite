<html>
    <head>
        <title>[% tbbfile %] test report</title>
        <style type="text/css">
            .test_ok {
                color: #006600;
            }
            .test_notok {
                color: #FF0000;
            }
            .text_red A {
                color: #FF0000;
            }
        </style>
    </head>
    <body>
        <h1>Bundle infos</h1>
        <ul>
            <li><b>Filename:</b> [% tbbfiles.$tbbfile.filename %]</li>
            <li><b>Version:</b> [% tbbfiles.$tbbfile.version %]</li>
            <li><b>Language:</b> [% tbbfiles.$tbbfile.language %]</li>
            <li><b>OS:</b> [% tbbfiles.$tbbfile.os %]</li>
            <li><b>Architecture:</b> [% tbbfiles.$tbbfile.arch %]</li>
            <li><b>sha256sum:</b> [% tbbfiles.$tbbfile.sha256sum %]</li>
        </ul>
        <h1>Results</h1>
        [% FOREACH test IN tbbfiles.$tbbfile.tests %]
        [% IF ! test.results; NEXT; END %]
        <h3>[% test.name %]</h3>
        <ul>
            <li><b>Test type:</b> [% test.type %]</li>
            <li><b>Status:</b>
            [% IF test.results.success %]
                <span class="test_ok">OK</span>
            [% ELSE %]
                <span class="test_notok">NOT OK</span>
            [% END %]
            </li>
            [% IF test.type == 'mozmill' %]
                    <li><b>Passed tests:</b>
                    [% GET test.results.results.0.passed %]/[% GET test.results.results.0.passed + test.results.results.0.failed %]
                    </li>
                    <li><a href="results-[% tbbfile %]/[% test.name %].json">json results</a></li>
            [% ELSIF test.type == 'selenium' %]
                    [% SET stests = test.results.total_tests - test.results.failed.size %]
                    <li><b>Passed tests:</b> [% stests %]/[% test.results.total_tests %]</li>
                    <li><a href="results-[% tbbfile %]/[% test.name %].json">json results</a></li>
            [% ELSIF test.type == 'tor_bootstrap' %]
                    <li><a href="results-[% tbbfile %]/tor.log">tor daemon logs</a></li>
            [% ELSIF test.type == 'virustotal' %]
                    [% FOREACH file IN test.results.files.keys %]
                    <li>virustotal report:
                    <span [% IF test.results.files.$file.positives %]class="text_red"[% END %]>
                        <a href="[% test.results.files.$file.permalink %]">[% file %]</a>
                    </span>
                    </li>
                    [% END %]
            [% END %]
        </ul>
        [% IF test.type == 'selenium' && test.results.failed %]
                [% FOREACH f IN test.results.failed %]
                        <b>Failed test:</b> [% f.id %]<br />
                        <pre>[% f.error %]</pre><br />
                [% END %]
        [% ELSIF test.type == 'mozmill' && test.results.results.0.failed %]
                [% FOREACH f IN test.results.results.0.fails %]
                        [% FOREACH v IN f.values %]
                                <b>Error:</b> [% v.name %]<br />
                                <pre>[% v.message %]</pre><br />
                        [% END %]
                [% END %]
        [% END %]
        [% END %]

        <hr>
        <h1>Screenshots</h1>
        [% FOREACH test IN tbbfiles.$tbbfile.tests %]
          [% IF test.screenshots && test.screenshots.size %]
            <h3>[% test.name %]</h3>
            [% FOREACH screenshot IN test.screenshots %]
            <a href="results-[% tbbfile %]/[% screenshot %]"><img src="results-[% tbbfile %]/t-[% screenshot %]" /></a><br /><br />
            [% END %]
          [% END %]
        [% END %]
    </body>
</html>
